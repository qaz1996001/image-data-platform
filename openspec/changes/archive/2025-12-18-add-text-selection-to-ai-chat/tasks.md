## 1. 文字選取工具函數
- [x] 1.1 建立 `frontend/src/utils/textSelection.ts` 工具函數
- [x] 1.2 實作獲取當前選取文字的功能
- [x] 1.3 實作文字選取事件監聽器
- [x] 1.4 處理不同瀏覽器的文字選取差異

## 2. 拖曳功能實作
- [x] 2.1 在 `FloatingButton` 組件添加拖曳接收區域
- [x] 2.2 實作 `onDragOver` 和 `onDrop` 事件處理
- [x] 2.3 在 `ChatDialog` 組件添加拖曳接收區域
- [x] 2.4 添加拖曳時的視覺反饋（高亮、圖標變化等）
- [x] 2.5 處理拖曳數據格式（文字內容）
- [x] 2.6 建立 `TextSelectionDragHandle` 組件，讓選取的文字區域可直接拖曳

## 3. 右鍵選單功能
- [x] 3.1 建立全局右鍵選單組件或 hook
- [x] 3.2 監聽文字選取時的右鍵事件
- [x] 3.3 顯示「發送到 AI 助手」選單項
- [x] 3.4 處理選單項點擊，將文字發送到 AI 對話
- [x] 3.5 確保右鍵選單不與瀏覽器原生選單衝突

## 4. 自動填充功能
- [ ] 4.1 實作將選取文字填充到輸入框
- [ ] 4.2 提供選項：填充到輸入框 vs 直接發送
- [ ] 4.3 處理長文字的截斷或換行
- [ ] 4.4 添加來源標記（如「來自報告詳情」）

## 5. 狀態管理整合
- [ ] 5.1 在 `aiAssistantStore` 中添加選取文字狀態
- [ ] 5.2 實作添加選取文字到對話的 action
- [ ] 5.3 處理拖曳和右鍵選單觸發的狀態更新

## 6. UI/UX 優化
- [ ] 6.1 添加拖曳時的視覺提示動畫
- [ ] 6.2 優化右鍵選單樣式和位置
- [ ] 6.3 添加成功提示（文字已添加到對話）
- [ ] 6.4 處理錯誤情況（如選取內容為空）

## 7. 測試
- [ ] 7.1 單元測試：文字選取工具函數
- [ ] 7.2 單元測試：拖曳功能
- [ ] 7.3 單元測試：右鍵選單功能
- [ ] 7.4 E2E 測試：完整拖曳流程
- [ ] 7.5 E2E 測試：完整右鍵選單流程

## 8. 驗證
- [x] 8.1 執行 `openspec validate add-text-selection-to-ai-chat --strict`
- [x] 8.2 修正所有驗證錯誤
- [x] 8.3 確認所有需求都有至少一個場景

